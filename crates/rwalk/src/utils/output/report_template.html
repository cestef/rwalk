<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rwalk Scan Report - {base_url}</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {{
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }}
        header {{
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }}
        .summary {{
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin-bottom: 2rem;
        }}
        .summary-box {{
            flex: 1;
            min-width: 250px;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }}
        .charts {{
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin-bottom: 2rem;
        }}
        .chart {{
            flex: 1;
            min-width: 300px;
            height: 300px;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }}
        table {{
            width: 100%;
            border-collapse: collapse;
            margin-top: 2rem;
        }}
        th, td {{
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }}
        th {{
            background-color: #f8f8f8;
            font-weight: 600;
        }}
        tr:hover {{
            background-color: #f5f5f5;
        }}
        .success {{ color: #28a745; }}
        .redirect {{ color: #007bff; }}
        .client-error {{ color: #ffc107; }}
        .server-error {{ color: #dc3545; }}
        .unknown {{ color: #6c757d; }}
        .filter-controls {{
            margin: 1rem 0;
            display: flex;
            gap: 1rem;
            align-items: center;
        }}
        .search {{
            padding: 0.5rem;
            flex: 1;
            max-width: 500px;
        }}
        footer {{
            margin-top: 3rem;
            text-align: center;
            font-size: 0.9rem;
            color: #666;
        }}
    </style>
</head>
<body>
    <header>
        <h1>rwalk Scan Report</h1>
        <p>Base URL: <a href="{base_url}" target="_blank">{base_url}</a></p>
        <p>Scan Date: {date}</p>
    </header>
    
    <div class="summary">
        <div class="summary-box">
            <h2>Results Summary</h2>
            <p>Total Endpoints: <strong>{total}</strong></p>
            <p>Directories: <strong>{directories}</strong></p>
            <p>Files: <strong>{files}</strong></p>
            <p>Errors: <strong>{errors}</strong></p>
        </div>
        
        <div class="summary-box">
            <h2>Status Code Distribution</h2>
            <div id="status-summary">
                {status_summary}
            </div>
        </div>
    </div>
    
    <div class="charts">
        <div class="chart">
            <canvas id="statusChart"></canvas>
        </div>
        <div class="chart">
            <canvas id="contentTypeChart"></canvas>
        </div>
    </div>
    
    <h2>Discovered Endpoints</h2>
    
    <div class="filter-controls">
        <input type="text" id="searchInput" class="search" placeholder="Search endpoints...">
        <select id="statusFilter">
            <option value="all">All Status Codes</option>
            <option value="2xx">2xx Success</option>
            <option value="3xx">3xx Redirect</option>
            <option value="4xx">4xx Client Error</option>
            <option value="5xx">5xx Server Error</option>
        </select>
        <select id="typeFilter">
            <option value="all">All Types</option>
            <option value="directory">Directories</option>
            <option value="file">Files</option>
            <option value="error">Errors</option>
        </select>
    </div>
    
    <table id="endpointsTable">
        <thead>
            <tr>
                <th>URL</th>
                <th>Status</th>
                <th>Response Time</th>
                <th>Type</th>
                <th>Size (bytes)</th>
            </tr>
        </thead>
        <tbody>
            {table_rows}
        </tbody>
    </table>
    
    <footer>
        <p>Generated by rwalk - A blazingly fast web directory scanner</p>
    </footer>
    
    <script>
        // Status chart
        const statusCtx = document.getElementById('statusChart').getContext('2d');
        const statusData = [{status_chart_data}];
        
        new Chart(statusCtx, {{
            type: 'pie',
            data: {{
                labels: statusData.map(d => `${{d.status}} (${{d.count}})`),
                datasets: [{{
                    data: statusData.map(d => d.count),
                    backgroundColor: statusData.map(d => {{
                        if (d.status >= 200 && d.status < 300) return '#28a745';
                        if (d.status >= 300 && d.status < 400) return '#007bff';
                        if (d.status >= 400 && d.status < 500) return '#ffc107';
                        if (d.status >= 500 && d.status < 600) return '#dc3545';
                        return '#6c757d';
                    }}),
                }}]
            }},
            options: {{
                plugins: {{
                    title: {{
                        display: true,
                        text: 'Status Codes'
                    }}
                }}
            }}
        }});
        
        // Content type chart
        const contentCtx = document.getElementById('contentTypeChart').getContext('2d');
        const contentData = [{content_chart_data}];
        
        new Chart(contentCtx, {{
            type: 'bar',
            data: {{
                labels: contentData.map(d => d.type),
                datasets: [{{
                    label: 'File Types',
                    data: contentData.map(d => d.count),
                    backgroundColor: '#007bff',
                }}]
            }},
            options: {{
                plugins: {{
                    title: {{
                        display: true,
                        text: 'Content Types'
                    }}
                }},
                scales: {{
                    y: {{
                        beginAtZero: true,
                        ticks: {{
                            precision: 0
                        }}
                    }}
                }}
            }}
        }});
        
        // Table filtering
        const searchInput = document.getElementById('searchInput');
        const statusFilter = document.getElementById('statusFilter');
        const typeFilter = document.getElementById('typeFilter');
        const table = document.getElementById('endpointsTable');
        const rows = table.getElementsByTagName('tr');
        
        function filterTable() {{
            const searchTerm = searchInput.value.toLowerCase();
            const statusValue = statusFilter.value;
            const typeValue = typeFilter.value;
            
            for (let i = 1; i < rows.length; i++) {{
                const row = rows[i];
                const url = row.cells[0].textContent.toLowerCase();
                const statusCode = parseInt(row.cells[1].textContent);
                const typeText = row.cells[3].textContent.toLowerCase();
                
                let showRow = url.includes(searchTerm);
                
                // Status filtering
                if (statusValue !== 'all') {{
                    if (statusValue === '2xx' && (statusCode < 200 || statusCode >= 300)) showRow = false;
                    if (statusValue === '3xx' && (statusCode < 300 || statusCode >= 400)) showRow = false;
                    if (statusValue === '4xx' && (statusCode < 400 || statusCode >= 500)) showRow = false;
                    if (statusValue === '5xx' && (statusCode < 500 || statusCode >= 600)) showRow = false;
                }}
                
                // Type filtering
                if (typeValue !== 'all') {{
                    if (typeValue === 'directory' && !typeText.includes('directory')) showRow = false;
                    if (typeValue === 'file' && !typeText.includes('file')) showRow = false;
                    if (typeValue === 'error' && !typeText.includes('error')) showRow = false;
                }}
                
                row.style.display = showRow ? '' : 'none';
            }}
        }}
        
        searchInput.addEventListener('input', filterTable);
        statusFilter.addEventListener('change', filterTable);
        typeFilter.addEventListener('change', filterTable);
    </script>
</body>
</html>